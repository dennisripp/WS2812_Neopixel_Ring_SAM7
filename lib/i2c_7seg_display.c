//#include "kernel.h"
//#include "kernel_id.h"
//#include "ecrobot_interface.h"
#include "sonar.h"


#define LOWSPEED_9V 1
#define LOWSPEED    2

//          P4              +---------------------------------+
//        =====             |              PCA 8574A          |
//      ||     ||           |  P7  P6  P5  P4  P3  P2  P1  P0 |
//   P5 ||     || P0        +---------------------------------|
//      || P6  ||              |   |   |   |   |   |   |   |    | /|
//        =====                    |                       +----|/ |--- +5V
//      ||     ||                  |                            | \| P0
//   P3 ||     || P1               |
//      ||     ||                  |                            | /|
//        =====                    +----------------------------|/ |--- +5V
//          P2                                                  | \| P6
//Hinweis:
//- LED's sind LOW-Aktiv

static int matrix[18]=
{ 
	0x3F,		//'0' 	0011 1111 //0
	0x03,		//'1' 	0000 0011 //1
	0x5D,		//'2' 	0101 1101 //2
	0x57,		//'3' 	0101 0111 //3
	0x63,		//'4' 	0110 0011 //4 
	0x76,		//'5' 	0111 0110 //5
	0x7E,		//'6' 	0111 1110 //6
	0x13,		//'7' 	0001 0011 //7
	0x7F,		//'8' 	0111 1111 //8
	0x77,		//'9' 	0111 0111 //9
	0x30,		//'f1'	0011 0000 //10
	0x11,		//'f2'  0001 0001 //11
	0x03,		//'f3'  0000 0011 //12
	0x06,		//'f4'  0000 0110 //13
	0x0C,		//'f5'  0000 1100 //14
	0x28,		//'f6'  0010 1000 //15
	0x31,		//'UP'	0011 0001 //16
	0x0E,		//'DW'	0000 1110 //17
};				

/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
/**
@brief     
@details   Initialisierung der 7-Segment Anzeige
@param     int port  --> NXT_PORT_Sx
@return    
*/
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void segment_display_init(int port)
{
ecrobot_init_i2c(port,LOWSPEED);
}

/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
/**
@brief     
@details   Wert anzeigen
@param     int port    --> NXT_PORT_Sx
@param     int state   --> 0..17  
@return    
@note      Durchlaufzeit der Routine: ca 10ms           
*/
/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
void display_segment(int port,int state)
{
  ecrobot_send_i2c(port, 0x20,matrix[state]^0xff,0,0);
}
